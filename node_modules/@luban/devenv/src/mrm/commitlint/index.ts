import {install, json} from "mrm-core";
import MrmTask from "../../types/MrmTask";

const lintBeforeCommit = function lintBeforeCommit() {
    json(".huskyrc.json")
        .set("hooks.pre-commit", "lint-staged")
        .save();

    json(".lintstagedrc")
        .set("['*.{ts,tsx}']", ["sh -c \"yarn tsc --noEmit\"", "lint-fix", "git add"]) // lodash with dot in path
        .set("['*.{js,jsx}']", ["lint-fix", "git add"])
        .save();

    install(["husky", "lint-staged"], {yarn: true});
};

const task: MrmTask = function git() {
    lintBeforeCommit();
};
task.description = "Setup commit lint for Luban developer";
export = task;
